# Basic data visualisation

# Demonstrated methods include treemapping, donut plots, comparative dot plots, and scatter plots with marginal distributions. 
# Work is based off a project at Market Economics and includes identifying statistically significant clusters of Maori across the region (related to original M.E project). 
# Data is simply selected 2018 census variables for SA1's across Southland.

# libraries -----------------------------
library(sf)        # for spatial data handling
library(spdep)     # for dealing with spatial dependency
library(tmap)      # for quick mapping
library(ggplot)    # for gneral data vis
library(tidyverse) # assorted 'tidy' libraries

# switch tmap from static to interactive plotting
temap_mode("view")


# read in sa1 data ----------------------
data_sa1 <- read_sf("", '') %>%
  filter(ta == "Southland") %>% # filter to only include Southland sa1's
  select(sa1) # only need sa1 id + geom

# read in census data -------------------
data_variables <- read_csv("")


# identify Maori clusters ---------------
# original project called for identification of Maori clusters for reporting and future analysis. utilised local indicator of spatial autocorrelation (LISA) to identify clusters.
# identified clusters were checked by local experts (including iwi members) who verified their accuracy.

# create spatial weights
# tells us who neighbours who
queen_w <- ...

# apply LISA classification


# quickly check results
qtm(x, fill = lisa_class)

# join classifications to census dataset
data_variables <- data_variables %>%
  left_join(data_lisa %>%
              as_tibble() %>%
              select(sa1, lisa_class),
            by = "sa1") %>%
  relocate(geom, .after = last_col())
  
# have now produced our master dataset :)

# treemaps -------------------------------
# ...


# donut plots ----------------------------
# clearer variation of the (correctly) much maligned pie chart.


# comparative dot plots ------------------
# highlights the differences between values.


# scatter plots --------------------------
# includes marginal distributions which provide additional visual information without cluttering the main vis panel.
# histogram is used here, but other marginal distribution options include density and boxplots.


#####
